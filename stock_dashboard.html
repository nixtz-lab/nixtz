<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Stock Dashboard | TMT</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    <script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'tmt-primary': '#00A99D', // Teal/Green
                    'tmt-secondary': '#FFC700', // Gold/Yellow
                    'tmt-bg': '#121212', // Dark background
                    'tmt-card': '#1f1f1f', // For dropdown background
                },
                fontFamily: {
                    sans: ['Inter', 'sans-serif'], // Sets Inter as default font
                },
                boxShadow: { // For dropdown shadow
                    '3xl-dark': '0 35px 60px -15px rgba(0, 0, 0, 0.5)',
                }
            }
        }
    }
    </script>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="script.js" defer></script>
    <script src="stock_dashboard.js" defer></script>

    <style>
        /* All CSS remains here */
        body { font-family: 'Inter', sans-serif; background-color: #101010; }
        #price-icon { font-size: 1.25rem; line-height: 1; margin-right: 0.25rem; }
        #tradingview-chart-container { height: 500px; min-height: 300px; width: 100%; }
        .user-rating-circle {
            width: 60px; height: 60px; border-radius: 0.5rem; display: flex; /* <-- MODIFIED: Changed 50% to 0.5rem */
            align-items: center; justify-content: center; font-weight: bold;
            font-size: 1.5rem; cursor: pointer; transition: all 0.2s ease-in-out;
            background-color: transparent; border-width: 2px;
        }
        .user-rating-circle:hover { transform: scale(1.05); }
        .user-rating-text { font-size: 0.875rem; text-align: center; line-height: 1.2; }

        /* New Styles for Dropdown Search */
        .search-container { position: relative; }
        .search-suggestions {
            position: absolute;
            top: 100%; /* Position right below the input */
            left: 0;
            right: 0;
            z-index: 50;
            max-height: 300px;
            overflow-y: auto;
            background-color: #1F2937; /* Dark background */
            border: 1px solid #374151;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }
        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.15s;
            color: #D1D5DB;
            font-size: 14px;
        }
        .suggestion-item:hover {
            background-color: #374151;
            color: #00A99D; /* Highlight color */
        }
        
        /* === NEW CLASS FOR SUMMARY CLAMPING === */
        .summary-clamped {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 3;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-tmt-bg font-sans antialiased min-h-screen">

    <div id="message-box" class="fixed top-4 right-4 p-4 rounded-lg shadow-2xl z-[9999] hidden text-white bg-tmt-primary transition duration-300 opacity-0">
        <p id="message-text" class="font-semibold"></p>
    </div>

<header class="bg-tmt-bg shadow-2xl sticky top-0 z-50 border-b border-gray-800">
    <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-3 flex items-center justify-between">

        <div class="flex items-center space-x-4">
            <a href="index.html">
                <img
                    src="images/Think money tree logo 4.png"
                    alt="Think Money Tree Logo"
                    class="h-14 sm:h-16 w-auto rounded-xl"
                    title="Think Money Tree Logo"
                >
            </a>

            <form id="header-search-form" class="mx-4 flex-grow max-w-lg hidden sm:block"> <div class="relative search-container">
                    <input type="text" id="stock-search-input" placeholder="Search Ticker (e.g., BRK.B, GE)" class="w-full bg-gray-700 text-white border border-gray-600 rounded-full py-2 pl-4 pr-12 text-sm focus:border-tmt-primary focus:ring-1 focus:ring-tmt-primary transition duration-200">
                    <button type="submit" class="absolute inset-y-0 right-0 flex items-center pr-3 text-tmt-primary hover:text-tmt-secondary transition duration-150">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </button>
                    <div id="stock-search-suggestions" class="search-suggestions hidden"></div>
                </div>
            </form>
            </div>

        <div class="flex items-center space-x-4 sm:space-x-6">
            
            <a href="javascript:void(0)" onclick="checkAccessAndRedirect('watchlist.html')" 
               class="text-tmt-primary hover:text-tmt-secondary transition duration-300 focus:outline-none font-medium ml-4 sm:ml-6 flex flex-col items-center justify-center leading-none" 
               title="Watchlist">
                <i data-lucide="eye" class="w-5 h-5"></i>
                <span class="text-[10px] leading-tight md:text-[10px] md:leading-tight">Watchlist</span>
            </a>
            <nav id="desktop-nav-links" class="hidden md:flex space-x-3 text-sm">

                <div class="relative group">
                    <button class="text-gray-400 hover:text-tmt-primary transition duration-300 flex items-center focus:outline-none whitespace-nowrap">
                        Finance
                        <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute left-1/2 transform -translate-x-1/2 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700 whitespace-nowrap">
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('budget_tracker.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Budget Dashboard</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('budget_planner.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Monthly Planner</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('transactions.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Transaction History</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('reports.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Reports & Analysis</a>
                    </div>
                </div>
                
                <div class="relative group">
                    <button class="text-tmt-primary font-bold transition duration-300 flex items-center focus:outline-none whitespace-nowrap">Stock <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
                    <div class="absolute left-1/2 transform -translate-x-1/2 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700">
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('tmt_dashboard.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Dashboard</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('52_week_low.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">52 Week Low</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_ranking_list.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Stock Ranking List</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_dashboard.html?mode=search')" class="block px-4 py-2 text-tmt-secondary hover:bg-gray-700 hover:text-tmt-primary rounded-md text-left font-semibold">TMT Stock Analyzer</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_valuation.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Valuation Tool</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('portfolio_tracker.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Portfolio Tracker</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('investing_for_beginners.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Investing for Beginners</a>
                    </div>
                </div>

                <div class="relative group">
                    <button class="text-gray-400 hover:text-tmt-primary transition duration-300 flex items-center focus:outline-none whitespace-nowrap">
                        Crypto
                        <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute left-1/2 transform -translate-x-1/2 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700 whitespace-nowrap">
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('crypto_market.html')"class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Crypto Market</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('crypto_strategies.html')"class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Crypto Strategies</a>
                        <a href="crypto_for_beginners.html" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Crypto for Beginners</a>
                    </div>
                </div>

                <div class="relative group">
                    <button class="text-gray-400 hover:text-tmt-primary transition duration-300 flex items-center focus:outline-none whitespace-nowrap">
                        Real Estate
                        <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute left-1/2 transform -translate-x-1/2 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700 whitespace-nowrap">
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('rental_property_analysis.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Rental Property Analysis</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('reit_investing_guide.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">REIT Investing Guides</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('Crowdfunding_&_Debt.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Crowdfunding & Debt</a>
                    </div>
                </div>

                <div class="relative group">
                    <button class="text-gray-400 hover:text-tmt-primary transition duration-300 flex items-center focus:outline-none whitespace-nowrap">
                        Retirement
                        <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute left-1/2 transform -translate-x-1/2 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700 whitespace-nowrap">
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('passive_income.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Passive Income</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('retirement_tracker.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Retirement Tracker</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('retirement_calculator.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Retirement Calculator</a>
                    </div>
                </div>

                <div class="relative group">
                    <button class="text-gray-400 hover:text-tmt-primary transition duration-300 flex items-center focus:outline-none whitespace-nowrap">
                        About
                        <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute right-0 top-full w-56 bg-gray-800 rounded-lg shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300 z-50 p-2 border border-gray-700 whitespace-nowrap">
                        <a href="about.html" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Our Story & Mission</a>
                        <a href="javascript:void(0)" onclick="checkAccessAndRedirect('meet_the_team.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Meet the Team</a>
                        <a href="disclaimer_legal.html" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Disclaimer & Legal</a>
                        <a href="contact.html" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Contact Us</a>
                    </div>
                </div>
            </nav>
            <button id="menu-toggle" class="md:hidden p-2 rounded-lg text-gray-400 hover:text-tmt-primary transition duration-200" aria-label="Toggle Menu">
                <svg id="icon-open" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                <svg id="icon-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            
            <div id="auth-buttons-container" class="flex items-center space-x-4 sm:space-x-6">
                <a href="auth.html?mode=login" id="login-button" class="bg-gray-800 hover:bg-gray-700 text-white font-bold py-1.5 px-4 md:px-5 rounded-full shadow-lg transition duration-300 transform hover:scale-105 border border-gray-700 text-sm md:text-sm">
                    Login
                </a>
                <a href="auth.html?mode=join" id="join-button" class="bg-tmt-primary hover:bg-[#009287] text-tmt-bg font-bold py-1.5 px-4 md:px-5 rounded-full shadow-lg transition duration-300 transform hover:scale-105 text-sm md:text-sm">
                    Join
                </a>
            </div>
            
            <div id="admin-link-container" class="hidden">
                 <a href="javascript:void(0)" onclick="checkAccessAndRedirect('admin_panel.html')" class="text-sm bg-tmt-secondary hover:bg-[#E5B800] text-tmt-bg font-bold py-1.5 px-3 rounded-full shadow-lg transition duration-300 transform hover:scale-105">
                    Admin
                </a>
            </div>
            <div id="user-menu-container" class="group relative flex items-center space-x-2 hidden"> 
                <button 
                    id="nav-user-button"
                    class="w-10 h-10 bg-tmt-primary rounded-full flex items-center justify-center font-bold text-tmt-bg hover:scale-105 transition duration-200"
                    title="User Settings">
                    <i data-lucide="user" class="w-6 h-6"></i>
                </button>
                <span id="username-display" class="font-semibold text-white hidden sm:inline">User</span>

                <div id="user-dropdown" class="absolute right-0 top-full mt-3 w-64 bg-gray-800 rounded-xl shadow-3xl-dark border border-gray-700/50 p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 origin-top-right scale-95 group-hover:scale-100 z-50">
                    
                    <p class="text-sm font-medium text-white mb-3 border-b border-gray-700 pb-2">Account: <span id="user-initials" class="font-normal text-tmt-secondary"></span></p>

                    <button id="profile-button" class="w-full text-left text-sm text-gray-300 hover:text-white transition duration-200 font-medium py-2 px-3 rounded-lg hover:bg-gray-700 mb-3">
                        <i data-lucide="settings" class="w-4 h-4 mr-2 inline"></i>
                        Profile & Password
                    </button>
                    <div class="mb-4">
                        <label for="currency-select" class="block text-xs font-medium text-gray-400 mb-1">Currency (Coming Soon)</label>
                        <select id="currency-select" 
                                class="w-full p-2 rounded-lg bg-tmt-card border border-gray-700 text-sm text-white appearance-none cursor-not-allowed transition duration-200 disabled:opacity-50" disabled>
                            <option value="USD">USD ($)</option>
                        </select>
                    </div>

                    <button id="logout-button" class="w-full text-center text-sm text-red-400 hover:text-red-500 transition duration-200 font-medium py-2 px-3 rounded-lg hover:bg-gray-700">
                        <i data-lucide="log-out" class="w-4 h-4 mr-2 inline"></i>
                        Logout
                    </button>
                </div>
                
            </div>
            </div>
    </div>

    <div id="mobile-menu" class="hidden md:hidden bg-gray-900 absolute w-full shadow-2xl border-b border-gray-800 z-40 text-sm">
        <div class="px-4 pt-2 pb-4 space-y-2">

            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-gray-300 hover:text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-semibold transition duration-200">
                    Finance
                    <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="pl-4 pt-1 space-y-1 hidden" data-dropdown-content>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('budget_tracker.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Budget Dashboard</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('budget_planner.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Monthly Planner</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('transactions.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Transaction History</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('reports.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Reports & Analysis</a>
                </div>
            </div>
            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-bold transition duration-200">Stock <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
                <div class="pl-4 pt-1 space-y-1 hidden">
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('tmt_dashboard.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Dashboard</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('52_week_low.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">52 Week Low</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_ranking_list.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Stock Ranking List</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_dashboard.html?mode=search')" class="block px-4 py-2 text-tmt-secondary hover:bg-gray-700 hover:text-tmt-primary rounded-md text-left font-semibold">TMT Stock Analyzer</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('stock_valuation.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Valuation Tool</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('portfolio_tracker.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">TMT Portfolio Tracker</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('investing_for_beginners.html')" class="block px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-tmt-secondary rounded-md text-left">Investing for Beginners</a>
                    
                </div>
            </div>

            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-gray-300 hover:text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-semibold transition duration-200">
                    Crypto
                    <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="pl-4 pt-1 space-y-1 hidden" data-dropdown-content>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('crypto_market.html')"class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Crypto Market</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('crypto_strategies.html')"class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Crypto Strategies</a>
                    <a href="crypto_for_beginners.html" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Crypto for Beginners</a>
                </div>
            </div>

            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-gray-300 hover:text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-semibold transition duration-200">
                    Real Estate
                    <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="pl-4 pt-1 space-y-1 hidden" data-dropdown-content>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('rental_property_analysis.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Rental Property Analysis</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('reit_investing_guide.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">REIT Investing Guides</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('Crowdfunding_&_Debt.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Crowdfunding & Debt</a>
                </div>
            </div>

            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-gray-300 hover:text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-semibold transition duration-200">
                    Retirement
                    <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="pl-4 pt-1 space-y-1 hidden" data-dropdown-content>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('passive_income.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Passive Income</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('retirement_tracker.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Retirement Tracker</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('retirement_calculator.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Retirement Calculator</a>
                </div>
            </div>

            <div>
                <button onclick="toggleMobileDropdown(this)" class="w-full text-left py-2 px-3 text-gray-300 hover:text-tmt-primary flex items-center justify-between rounded-lg bg-gray-800 hover:bg-gray-700 font-semibold transition duration-200">
                    About
                    <svg class="w-4 h-4 transform transition duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="pl-4 pt-1 space-y-1 hidden" data-dropdown-content>
                    <a href="about.html" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Our Story & Mission</a>
                    <a href="javascript:void(0)" onclick="checkAccessAndRedirect('meet_the_team.html')" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Meet the Team</a>
                    <a href="disclaimer_legal.html" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Disclaimer & Legal</a>
                    <a href="contact.html" class="block px-4 py-2 text-gray-400 hover:bg-gray-800 hover:text-tmt-secondary rounded-md">Contact Us</a>
                </div>
            </div>

        </div>
    </div>
    </header>
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

        <div id="search-prompt-container" class="flex flex-col items-center justify-center text-center py-20 px-6 bg-gray-900 rounded-2xl shadow-2xl border border-tmt-primary/50 my-16 mx-auto max-w-3xl">
            <h2 class="text-4xl font-extrabold text-white mb-3">Welcome to Think Money Tree Stock Analyzer!</h2>
            <p class="text-xl font-light text-tmt-secondary mb-10 max-w-xl">
                Start your deep-dive valuation by searching for a stock ticker below.
            </p>
            <form class="w-full max-w-md">
                <div class="relative search-container">
                    <input type="text" id="main-search-input" placeholder="Enter Ticker (e.g., BRK.B, MSFT)" class="w-full bg-gray-700/50 text-white border border-tmt-primary rounded-full py-4 pl-6 pr-16 text-lg placeholder-gray-400 focus:ring-4 focus:ring-tmt-secondary focus:border-tmt-secondary transition duration-200 shadow-xl">
                    <button type="submit" class="absolute inset-y-0 right-0 flex items-center pr-4 text-tmt-secondary hover:text-tmt-primary transition duration-150">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </button>
                    <div id="main-search-suggestions" class="search-suggestions hidden"></div>
                </div>
            </form>
        </div>

        <div id="stock-details-container" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <header class="flex flex-col sm:flex-row sm:items-baseline sm:space-x-4">
                    <div class="flex items-baseline space-x-3">
                        <h1 id="stock-ticker" class="text-3xl font-extrabold text-white">---</h1>
                        
                        <button id="add-to-watchlist-btn" onclick="addToWatchlist()" 
                                class="flex items-center space-x-1.5 bg-gray-700 hover:bg-tmt-primary text-tmt-primary hover:text-tmt-bg font-semibold py-1.5 px-3 rounded-full transition duration-300 transform hover:scale-105"
                                title="Add to Watchlist" style="padding-bottom: 4px;">
                            <i data-lucide="star" class="w-4 h-4"></i>
                            <span class="text-sm hidden sm:block">Add to Watchlist</span>
                        </button>
                        <p id="stock-company" class="text-gray-400 text-lg">Loading company name...</p>
                    </div>
                    <div class="flex items-center space-x-2 mt-1 sm:mt-0">
                        <span id="price-icon" class="text-lg"></span> <span id="current-price" class="text-2xl font-bold text-white">---</span>
                        <span id="price-change" class="text-lg font-semibold">---</span> </div>
                </header>
                <a href="index.html" class="hidden sm:inline-flex items-center text-gray-400 hover:text-tmt-primary font-semibold transition duration-300 group text-sm">
                    <svg class="w-4 h-4 mr-1 group-hover:-translate-x-0.5 transition duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    Back to Home
                </a>
            </div>
            
            <form id="mobile-search-form" class="mb-6 md:hidden hidden">
                 <div class="relative search-container">
                    <input type="text" id="stock-search-input-mobile" placeholder="Search Ticker (e.g., BRK.B, GE)" class="w-full bg-gray-700 text-white border border-gray-600 rounded-full py-2 pl-4 pr-12 text-sm focus:border-tmt-primary focus:ring-1 focus:ring-tmt-primary transition duration-200">
                    <button type="submit" class="absolute inset-y-0 right-0 flex items-center pr-3 text-tmt-primary">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </button>
                    <div id="mobile-search-suggestions" class="search-suggestions hidden"></div>
                </div>
            </form>

            <div id="company-summary-container" class="bg-gray-900 rounded-xl shadow-xl border border-gray-800 p-4 mb-8">
                <h2 class="text-xl font-bold text-tmt-primary mb-2">Company Overview</h2>
                <p id="company-summary" class="text-gray-300 leading-relaxed text-base summary-clamped">Loading company summary...</p>
                <button id="toggle-summary-btn" class="text-tmt-primary hover:text-tmt-secondary font-semibold text-sm mt-2 hidden">
                    Show more
                </button>
            </div>
            <div class="bg-gray-900 rounded-xl shadow-xl border border-gray-800 p-2 sm:p-4 mb-8">
                <h2 class="text-lg font-bold text-white mb-2 ml-2 sm:ml-0">Price and Volume Action (Live View)</h2> <div id="tradingview-chart-container" class="h-[500px] w-full bg-gray-900/50 rounded-lg"></div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div class="lg:col-span-1 xl:col-span-1 bg-gray-800 rounded-xl p-4 border border-gray-700 shadow-lg">
                    <h3 class="text-xl font-bold text-tmt-primary mb-3 border-b border-gray-700 pb-2">Valuation & Growth</h3>
                    <div id="left-metrics-panel" class="divide-y divide-gray-700/50"></div>
                </div>

                <div class="lg:col-span-1 xl:col-span-1 bg-gray-800 rounded-xl p-4 border border-gray-700 shadow-lg">
                    <h3 class="text-xl font-bold text-tmt-primary mb-3 border-b border-gray-700 pb-2">Cash Flow & Capital</h3>
                    <div id="right-metrics-panel" class="divide-y divide-gray-700/50"></div>
                </div>

                <div class="lg:col-span-1 xl:col-span-2 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                        <div class="bg-gray-800 rounded-xl p-4 border border-gray-700 shadow-lg flex flex-col justify-between">
                            <h3 class="text-lg font-bold text-white mb-3">Think Money Tree Value Rating</h3>
                            <div class="flex flex-col items-center">
                                <div id="current-rating-box" class="p-3 rounded-xl text-tmt-bg font-extrabold text-xl shadow-inner transition duration-300 bg-gray-500">
                                    <span id="current-rating-label">N/A</span>
                                </div>
                                <div class="flex justify-between w-full mt-4 text-xs font-semibold text-gray-500 px-1">
                                    <span>Strong Sell</span><span>Hold</span><span>Strong Buy</span>
                                </div>
                                <div class="w-full h-4 bg-gray-700 rounded-full mt-1 flex overflow-hidden">
                                    <div id="rating-circle-1" class="w-1/5 h-full transition duration-300"></div>
                                    <div id="rating-circle-2" class="w-1/5 h-full transition duration-300"></div>
                                    <div id="rating-circle-3" class="w-1/5 h-full transition duration-300"></div>
                                    <div id="rating-circle-4" class="w-1/5 h-full transition duration-300"></div>
                                    <div id="rating-circle-5" class="w-1/5 h-full transition duration-300"></div>
                                </div>
                            </div>
                            <p class="text-xs text-gray-500 mt-3 text-center">TMT proprietary algorithm.</p>
                        </div>

                        <div id="rating-buy-panel" class="bg-gray-800 rounded-xl p-4 border border-gray-700 shadow-lg flex flex-col justify-between border-l-4 border-tmt-primary">
                             <h3 class="text-lg font-bold text-white mb-3">Community Sentiment</h3>
                            <div class="flex justify-center items-center h-28 relative">
                                <svg width="100" height="100" viewBox="0 0 40 40" class="transform -rotate-90">
                                    <circle cx="20" cy="20" r="15.91549430918954" fill="transparent" stroke="#1F2937" stroke-width="8"></circle>
                                    <circle id="sentiment-sell-circle" cx="20" cy="20" r="15.91549430918954" fill="transparent" stroke="#EF4444" stroke-width="8" stroke-dasharray="0 100" stroke-dashoffset="0"></circle>
                                    <circle id="sentiment-hold-circle" cx="20" cy="20" r="15.91549430918954" fill="transparent" stroke="#FACC15" stroke-width="8" stroke-dasharray="0 100" stroke-dashoffset="0"></circle>
                                    <circle id="sentiment-buy-circle" cx="20" cy="20" r="15.91549430918954" fill="transparent" stroke="#00A99D" stroke-width="8" stroke-dasharray="0 100" stroke-dashoffset="0"></circle>
                                </svg>
                                <div class="absolute text-center text-white">
                                    <p id="sentiment-donut-percent" class="text-xl font-bold">N/A</p>
                                    <p id="sentiment-donut-label" class="text-sm text-tmt-primary">N/A</p>
                                </div>
                            </div>
                            <div class="flex flex-wrap justify-center gap-x-3 gap-y-1 text-xs mt-3"> <span class="flex items-center text-gray-400"><span class="w-2.5 h-2.5 rounded-full bg-tmt-red mr-1.5"></span>Sell (<span id="sentiment-sell-text">0%</span>)</span>
                                <span class="flex items-center text-gray-400"><span class="w-2.5 h-2.5 rounded-full bg-tmt-yellow mr-1.5"></span>Hold (<span id="sentiment-hold-text">0%</span>)</span>
                                <span class="flex items-center text-gray-400"><span class="w-2.5 h-2.5 rounded-full bg-tmt-primary mr-1.5"></span>Buy (<span id="sentiment-buy-text">0%</span>)</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-800 rounded-xl p-6 border border-gray-700 shadow-lg flex flex-col items-center justify-center text-white space-y-6">
                        <h3 class="text-3xl font-extrabold text-white">Your Rating?</h3>
                        <div class="flex flex-wrap justify-center gap-x-4 gap-y-2 items-start mb-4"> <div class="flex flex-col items-center">
                                <div id="user-rating-1" onclick="selectUserRating(1)" class="user-rating-circle border-tmt-red text-tmt-red">1</div>
                                <span class="user-rating-text text-tmt-red mt-2">Strong<br>Sell</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="user-rating-2" onclick="selectUserRating(2)" class="user-rating-circle border-tmt-orange text-tmt-orange">2</div>
                                <span class="user-rating-text text-tmt-orange mt-2">Sell</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="user-rating-3" onclick="selectUserRating(3)" class="user-rating-circle border-tmt-yellow text-tmt-yellow">3</div>
                                <span class="user-rating-text text-tmt-yellow mt-2">Hold</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="user-rating-4" onclick="selectUserRating(4)" class="user-rating-circle border-tmt-blue text-tmt-blue">4</div>
                                <span class="user-rating-text text-tmt-blue mt-2">Buy</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="user-rating-5" onclick="selectUserRating(5)" class="user-rating-circle border-tmt-green text-tmt-green">5</div>
                                <span class="user-rating-text text-tmt-green mt-2">Strong<br>Buy</span>
                            </div>
                        </div>

                        <p id="user-rating-selection-label" class="text-2xl font-bold text-gray-400 h-8 flex items-center justify-center"></p>

                        <label class="flex items-center cursor-pointer text-gray-400 hover:text-white transition duration-200 text-lg">
                            <input type="checkbox" id="cannot-rate-checkbox" onchange="toggleCannotRate()" class="hidden">
                            <span class="w-5 h-5 rounded-md border-2 border-tmt-green flex items-center justify-center mr-3 flex-shrink-0"> <svg id="checkbox-icon" class="w-3 h-3 text-tmt-green hidden" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </span>
                            I don't know enough to rate
                        </label>

                        <button onclick="buttonAction('rate-stock')" class="bg-tmt-primary hover:bg-[#009287] text-tmt-bg font-bold py-3 px-8 rounded-full shadow-md transition duration-300 transform hover:scale-105 text-lg w-full sm:w-auto">
                            Rate this Stock
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex justify-center mt-12 pt-6 border-t border-gray-800">
                <a href="stock_valuation.html" id="valuation-cta" class="bg-tmt-secondary hover:bg-[#c3a800] text-tmt-bg font-bold py-3 px-12 rounded-full shadow-xl transition duration-300 transform hover:scale-105 text-lg w-full sm:w-auto inline-block text-center">
                    Think Money Tree Stock Valuation
                </a>
            </div>
        </div>
    </main>
    <footer class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 mt-12 border-t border-gray-800">
        <div class="text-center text-gray-500 text-sm">
            &copy; 2025 Think Money Tree. All rights reserved. Data provided for informational purposes only.
        </div>
    </footer>

    <div id="profile-modal" class="fixed inset-0 bg-black bg-opacity-75 z-[9999] hidden flex items-center justify-center p-4 transition-opacity duration-300">
        <div class="bg-tmt-card w-full max-w-lg rounded-xl shadow-3xl-dark p-6 md:p-8 border border-gray-700/50">
            <h2 class="text-2xl font-bold text-tmt-secondary mb-4 border-b border-gray-700 pb-3 flex justify-between items-center">
                User Profile Settings
                <button id="close-profile-modal" class="text-gray-400 hover:text-white transition duration-200">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </h2>
    
            <div class="mb-6">
                <p class="text-lg font-semibold text-white mb-2">Account Details</p>
                <div class="space-y-2 text-sm">
                    <p class="text-gray-400">Username: <span id="modal-username" class="text-white font-medium">Loading...</span></p>
                    <p class="text-gray-400">Email: <span id="modal-email" class="text-white font-medium">Loading...</span></p>
                </div>
            </div>
    
            <div class="mt-8 border-t border-gray-700 pt-6">
                <h3 class="text-xl font-semibold text-tmt-primary mb-4">Change Password</h3>
                <div id="password-message-box" class="p-3 rounded-lg text-white mb-3 hidden"></div>
                <form id="change-password-form" class="space-y-4">
                    <div>
                        <label for="current-password" class="block text-sm font-medium text-gray-400 mb-1">Current Password</label>
                        <input type="password" id="current-password" required
                               class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:border-tmt-primary transition duration-200">
                    </div>
                    <div>
                        <label for="new-password" class="block text-sm font-medium text-gray-400 mb-1">New Password</label>
                        <input type="password" id="new-password" required minlength="8"
                               class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:border-tmt-primary transition duration-200">
                    </div>
                    <div>
                        <label for="confirm-new-password" class="block text-sm font-medium text-gray-400 mb-1">Confirm New Password</label>
                        <input type="password" id="confirm-new-password" required minlength="8"
                               class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:border-tmt-primary transition duration-200">
                    </div>
                    <button type="submit" id="save-password-button"
                            class="w-full p-3 bg-tmt-primary text-tmt-bg rounded-lg font-bold shadow-lg hover:bg-[#009287] transition duration-300 transform hover:scale-[1.01] disabled:opacity-50">
                        Update Password
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <div id="cookie-consent-banner" class="fixed bottom-0 left-0 right-0 p-4 bg-gray-900 border-t border-tmt-primary z-[60] text-sm text-white shadow-2xl md:flex items-center justify-center space-x-6">
        <p class="text-gray-400 text-center md:text-left">
            This website uses cookies to enhance your experience. By clicking "Accept" or continuing to use the site, you agree to our 
            <a href="cookie_policy.html" class="text-tmt-secondary hover:text-tmt-primary transition duration-200 underline font-semibold" target="_blank">
                Cookie Policy.
            </a>
        </p>
        <button onclick="acceptCookies()" class="flex-shrink-0 bg-tmt-primary hover:bg-[#009287] text-tmt-bg font-bold py-2 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105 text-sm">
            Accept
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                lucide.createIcons();
            } catch (e) {
                console.error("Lucide icons failed to render.", e);
            }
        });
    </script>
</body>
</html>